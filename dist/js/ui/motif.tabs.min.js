/*!
 * Motif Tabs v0.2.0 (2014-04-30)
 * Requires Motif Reveal
 * http://getmotif.com
 * 
 * @author Jonathan Pacheco <jonathan@lifeblue.com>
 * @todo Autogenerate Tabs Nav, add better History support, add better docs
 */
!function(a,b,c,d){"use strict";var e=function(b){return this.$elem=a(b),this.elem=this.$elem[0],this},f=b.location,g=a(c);e.counter=0,e.hashChangeBound=!1,e.onHashChange=!1,e.animationFrame="function"==typeof b.requestAnimFrame?!0:!1,e.prototype={defaults:{animate:!0,cssTransition:!0,speed:300,easing:"swing",history:!1,tabsGroup:".tabs__section",revealOptions:{type:"radio",activeClass:"is-current"}},init:function(a){return this.$elem.length?(this.initVars(a),this.bindEvents(),this.initReveal(),this):void 0},initVars:function(b){this.config=b,this.metadata=this.$elem.data("tabs-options"),this.options=a.extend(!0,{},this.defaults,this.config,this.metadata),this.$triggers=this.gatherTriggers.call(this),this.$tabs=this.$elem.find(this.$elem.find(this.options.tabsGroup).length?this.options.tabsGroup:"nav + *"),this.group="tabs-group-"+e.counter,this.initialized=!1},gatherTriggers:function(){return this.$elem.find("nav a")},bindEvents:function(){var a=this;a.options.history&&(g.on("reveal/queue/done",function(){a.initialized=!0}),e.hashChangeBound||(b.onhashchange=function(){a.activateFromUrl.call(a)},e.hashChangeBound=!0))},activateFromUrl:function(){var b,c;e.onHashChange||(e.onHashChange=!0,b=""!==f.hash?a("[href='"+f.hash+"']"):!1,c=b.length?a.data(b[0],"reveal"):!1,c&&c.processTrigger.call(c),e.onHashChange=!1)},initReveal:function(){this.$triggers.reveal(this.createRevealConfig()),e.counter+=1},createRevealConfig:function(){var a=this;return a.options.revealOptions.target=function(){return a.gatherTargets.call(this)},a.options.revealOptions.onInit=function(){a.prepTabs.call(a,this)},a.options.revealOptions.onShow=function(){a.options.history&&a.updateLocation.call(a,this),a.options.animate&&a.animateTabs.call(a,this)},a.options.revealOptions.beforeHide=function(){a.options.history&&""===f.hash&&a.updateLocation.call(a,this),a.options.animate&&a.prepTransition.call(a,this)},a.options.revealOptions},gatherTargets:function(){var b=[];return b.push(a(this.$elem.attr("href"))),b},prepTabs:function(a){var b=this;b.createGroup.call(b,a),b.getCurrentTab.call(b,a),b.options.animate&&(b.options.cssTransition?b.$tabs.hasClass("transition-bound")||b.transitionEndCss():b.$tabs.addClass("no-transition"))},createGroup:function(a){return a.group=this.group,a.updateReference.call(a),a.group},getCurrentTab:function(c){var d=b.Reveal.queue,e=b.Reveal.groups,g=e[c.group].triggers[0];this.options.history&&f.hash===c.$elem.attr("href")?(a.inArray(g,d)>-1&&(d.splice(a.inArray(c.identity,d),1),b.Reveal.queue=d),c.setCurrent()):c.identity===g&&c.setCurrent()},transitionEndCss:function(){var a=this;a.$tabs.on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(b){b.originalEvent.target===a.$tabs[0]&&a.$tabs.removeAttr("style")}).addClass("transition-bound")},prepTransition:function(a){var b=a.reference.targets[0],c=this.$tabs.attr("style");c||this.$tabs.outerHeight(b.outerHeight())},updateLocation:function(a){this.initialized&&!e.onHashChange&&(e.onHashChange=!0,f.hash=a.$elem.attr("href"),e.onHashChange=!1)},animateTabs:function(a){var b=a.reference.targets[0],c=b.outerHeight();this.options.cssTransition?this.animateTabsCss(c):this.animateTabsJs(c)},animateTabsCss:function(a){var b=this;b.$tabs.outerHeight()!==a?e.animationFrame?requestAnimFrame(function(){b.$tabs.outerHeight(a)}):b.$tabs.outerHeight(a):b.$tabs.removeAttr("style")},animateTabsJs:function(a){var b=this;b.$tabs.stop().animate({height:a},b.options.speed,b.options.easing,function(){b.$tabs.removeAttr("style")})}},e.defaults=e.prototype.defaults,d.apps.Tabs=e}(jQuery,window,document,window.Motif=window.Motif||{utils:{},apps:{}}),$.createPlugin("tabs",window.Motif.apps.Tabs);